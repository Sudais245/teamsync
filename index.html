<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TeamSync - Employee Management Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        body { font-family: 'Inter', sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
        .glass-panel { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2); }
        .sidebar-item { transition: all 0.3s ease; }
        .sidebar-item:hover, .sidebar-item.active { background: linear-gradient(90deg, rgba(99, 102, 241, 0.1) 0%, transparent 100%); border-left: 3px solid #6366f1; }
        .pulse-ring { animation: pulse-ring 2s cubic-bezier(0.215, 0.61, 0.355, 1) infinite; }
        @keyframes pulse-ring { 0% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(99, 102, 241, 0.7); } 70% { transform: scale(1); box-shadow: 0 0 0 10px rgba(99, 102, 241, 0); } 100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(99, 102, 241, 0); } }
        .message-bubble { animation: slideIn 0.3s ease-out; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .calendar-day { min-height: 100px; transition: all 0.2s; cursor: pointer; }
        .calendar-day:hover { background-color: #f3f4f6; transform: scale(1.02); }
        .timer-display { font-variant-numeric: tabular-nums; letter-spacing: -0.02em; }
        .hidden-access { display: none !important; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 100; align-items: center; justify-content: center; }
        .modal.active { display: flex; }
        .modal-content { background: white; border-radius: 1rem; max-width: 500px; width: 90%; max-height: 90vh; overflow-y: auto; }
        .event-dot { width: 8px; height: 8px; border-radius: 50%; display: inline-block; margin-right: 4px; }
        .event-item { font-size: 0.75rem; padding: 2px 4px; border-radius: 4px; margin-top: 2px; cursor: pointer; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #c7c7c7; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #a0a0a0; }
    </style>
</head>
<body class="text-gray-800">

    <!-- Login Screen -->
    <div id="loginScreen" class="fixed inset-0 z-50 flex items-center justify-center bg-gradient-to-br from-indigo-600 to-purple-700">
        <div class="glass-panel p-8 rounded-2xl shadow-2xl w-full max-w-md mx-4">
            <div class="text-center mb-8">
                <div class="w-16 h-16 bg-indigo-600 rounded-xl flex items-center justify-center mx-auto mb-4 shadow-lg">
                    <i class="fas fa-users text-white text-2xl"></i>
                </div>
                <h1 class="text-3xl font-bold text-gray-800">TeamSync</h1>
                <p class="text-gray-600 mt-2">Select your role to continue</p>
            </div>
            
            <div class="space-y-4">
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <button onclick="selectRole('admin')" id="btn-admin" class="role-btn p-4 border-2 border-gray-200 rounded-xl hover:border-indigo-500 transition text-center">
                        <i class="fas fa-shield-alt text-2xl mb-2 text-indigo-600"></i>
                        <p class="font-semibold">Admin/HR</p>
                        <p class="text-xs text-gray-500">Full Access</p>
                    </button>
                    <button onclick="selectRole('employee')" id="btn-employee" class="role-btn p-4 border-2 border-gray-200 rounded-xl hover:border-indigo-500 transition text-center">
                        <i class="fas fa-user text-2xl mb-2 text-indigo-600"></i>
                        <p class="font-semibold">Employee</p>
                        <p class="text-xs text-gray-500">Limited Access</p>
                    </button>
                </div>

                <div id="loginFields" class="hidden space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Email Address</label>
                        <input type="email" id="loginEmail" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-500 outline-none" placeholder="you@company.com">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Password</label>
                        <input type="password" id="loginPassword" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-500 outline-none" placeholder="••••••••" value="password">
                    </div>
                    <button onclick="handleLogin()" class="w-full bg-indigo-600 text-white py-3 rounded-lg font-semibold hover:bg-indigo-700 transition shadow-lg">
                        Sign In as <span id="selectedRoleText">User</span>
                    </button>
                </div>
            </div>
            
            <div class="mt-6 text-center text-xs text-gray-500">
                <p>Demo: Any email works with password "password"</p>
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="mainApp" class="hidden h-screen flex overflow-hidden">
        
        <!-- Sidebar -->
        <aside class="w-64 bg-white shadow-xl flex flex-col z-20">
            <div class="p-6 border-b border-gray-200">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-indigo-600 rounded-lg flex items-center justify-center">
                        <i class="fas fa-users text-white"></i>
                    </div>
                    <div>
                        <h2 class="font-bold text-lg text-gray-800">TeamSync</h2>
                        <p class="text-xs text-gray-500" id="userRoleDisplay">Workspace</p>
                    </div>
                </div>
            </div>

            <nav class="flex-1 overflow-y-auto py-4">
                <div class="px-4 mb-2 text-xs font-semibold text-gray-400 uppercase tracking-wider">Main</div>
                <a href="#" onclick="switchTab('dashboard')" class="sidebar-item active flex items-center gap-3 px-6 py-3 text-gray-700 hover:text-indigo-600" id="nav-dashboard">
                    <i class="fas fa-home w-5"></i>
                    <span>Dashboard</span>
                </a>
                <a href="#" onclick="switchTab('attendance')" class="sidebar-item flex items-center gap-3 px-6 py-3 text-gray-700 hover:text-indigo-600" id="nav-attendance">
                    <i class="fas fa-clock w-5"></i>
                    <span>Time Tracker</span>
                </a>
                <a href="#" onclick="switchTab('calendar')" class="sidebar-item flex items-center gap-3 px-6 py-3 text-gray-700 hover:text-indigo-600" id="nav-calendar">
                    <i class="fas fa-calendar-alt w-5"></i>
                    <span>Calendar</span>
                </a>
                <a href="#" onclick="switchTab('employees')" class="sidebar-item flex items-center gap-3 px-6 py-3 text-gray-700 hover:text-indigo-600 admin-only" id="nav-employees">
                    <i class="fas fa-user-tie w-5"></i>
                    <span>Employees</span>
                </a>

                <div class="px-4 mt-6 mb-2 text-xs font-semibold text-gray-400 uppercase tracking-wider">Teams & Channels</div>
                <div id="channelsList" class="space-y-1"></div>
                
                <button onclick="createNewChannel()" class="mx-6 mt-3 text-sm text-indigo-600 hover:text-indigo-800 flex items-center gap-2 admin-only">
                    <i class="fas fa-plus"></i> Add Channel
                </button>

                <div class="px-4 mt-6 mb-2 text-xs font-semibold text-gray-400 uppercase tracking-wider">Messages</div>
                <a href="#" onclick="switchTab('messages')" class="sidebar-item flex items-center gap-3 px-6 py-3 text-gray-700 hover:text-indigo-600" id="nav-messages">
                    <i class="fas fa-comments w-5"></i>
                    <span>Direct Messages</span>
                    <span class="ml-auto bg-red-500 text-white text-xs rounded-full px-2 py-0.5" id="msgBadge">0</span>
                </a>
            </nav>

            <div class="p-4 border-t border-gray-200 bg-gray-50">
                <div class="flex items-center gap-3">
                    <img src="https://ui-avatars.com/api/?name=User&background=6366f1&color=fff" class="w-10 h-10 rounded-full" id="currentUserAvatar">
                    <div class="flex-1 min-w-0">
                        <p class="text-sm font-medium text-gray-900 truncate" id="currentUserName">User</p>
                        <p class="text-xs text-gray-500 truncate" id="currentUserRole">Role</p>
                    </div>
                    <button onclick="logout()" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 flex flex-col bg-gray-50 overflow-hidden">
            
            <!-- Top Header -->
            <header class="bg-white shadow-sm border-b border-gray-200 px-8 py-4 flex items-center justify-between">
                <div>
                    <h1 class="text-2xl font-bold text-gray-800" id="pageTitle">Dashboard</h1>
                    <p class="text-sm text-gray-500" id="currentDate">Loading...</p>
                </div>
                
                <div class="flex items-center gap-4">
                    <div class="relative admin-only">
                        <input type="text" placeholder="Search employees..." class="pl-10 pr-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-500 outline-none w-64">
                        <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                    </div>
                    <button class="p-2 text-gray-400 hover:text-gray-600 relative">
                        <i class="fas fa-bell text-xl"></i>
                        <span class="absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"></span>
                    </button>
                </div>
            </header>

            <!-- Content Area -->
            <div class="flex-1 overflow-y-auto p-8" id="contentArea">
                
                <!-- Dashboard View -->
                <div id="view-dashboard" class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                        <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm text-gray-500">Total Employees</p>
                                    <p class="text-3xl font-bold text-gray-800 mt-1" id="totalEmployees">0</p>
                                </div>
                                <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600">
                                    <i class="fas fa-users text-xl"></i>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm text-gray-500">Currently Working</p>
                                    <p class="text-3xl font-bold text-green-600 mt-1" id="workingCount">0</p>
                                </div>
                                <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center text-green-600">
                                    <i class="fas fa-user-check text-xl"></i>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm text-gray-500">On Leave</p>
                                    <p class="text-3xl font-bold text-orange-600 mt-1" id="leaveCount">0</p>
                                </div>
                                <div class="w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center text-orange-600">
                                    <i class="fas fa-coffee text-xl"></i>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm text-gray-500">Hours Today</p>
                                    <p class="text-3xl font-bold text-indigo-600 mt-1">0h</p>
                                </div>
                                <div class="w-12 h-12 bg-indigo-100 rounded-lg flex items-center justify-center text-indigo-600">
                                    <i class="fas fa-clock text-xl"></i>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Fixed Chart Container -->
                        <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100 admin-only">
                            <h3 class="text-lg font-semibold mb-4">Attendance Overview</h3>
                            <div style="height: 250px; position: relative;">
                                <canvas id="attendanceChart"></canvas>
                            </div>
                        </div>
                        <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                            <h3 class="text-lg font-semibold mb-4">My Activity</h3>
                            <div class="space-y-4" id="activityFeed">
                                <p class="text-gray-500 text-center py-8">No recent activity</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Time Tracker View -->
                <div id="view-attendance" class="hidden space-y-6">
                    <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-8 text-center max-w-2xl mx-auto">
                        <div class="mb-8">
                            <div class="inline-flex items-center justify-center w-24 h-24 rounded-full bg-indigo-50 mb-4 pulse-ring" id="timerCircle">
                                <i class="fas fa-play text-3xl text-indigo-600" id="timerIcon"></i>
                            </div>
                            <div class="timer-display text-6xl font-bold text-gray-800 font-mono tracking-tight" id="timerDisplay">00:00:00</div>
                            <p class="text-gray-500 mt-2" id="timerStatus">Ready to start your day</p>
                        </div>
                        
                        <div class="flex justify-center gap-4">
                            <button onclick="toggleTimer()" id="timerBtn" class="px-8 py-3 bg-indigo-600 text-white rounded-lg font-semibold hover:bg-indigo-700 transition shadow-lg flex items-center gap-2">
                                <i class="fas fa-play" id="timerBtnIcon"></i>
                                <span id="timerBtnText">Clock In</span>
                            </button>
                            <button onclick="takeBreak()" id="breakBtn" class="px-8 py-3 bg-orange-100 text-orange-700 rounded-lg font-semibold hover:bg-orange-200 transition hidden">
                                <i class="fas fa-coffee mr-2"></i>Take Break
                            </button>
                        </div>

                        <div class="mt-8 pt-8 border-t border-gray-200 grid grid-cols-3 gap-4 text-center">
                            <div>
                                <p class="text-2xl font-bold text-gray-800">0h 00m</p>
                                <p class="text-sm text-gray-500">Today</p>
                            </div>
                            <div>
                                <p class="text-2xl font-bold text-gray-800">0h 00m</p>
                                <p class="text-sm text-gray-500">This Week</p>
                            </div>
                            <div>
                                <p class="text-2xl font-bold text-gray-800">0h 00m</p>
                                <p class="text-sm text-gray-500">This Month</p>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden admin-only">
                        <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                            <h3 class="text-lg font-semibold">Team Activity</h3>
                            <button onclick="generateReport()" class="text-indigo-600 hover:text-indigo-800 text-sm font-medium">
                                <i class="fas fa-download mr-1"></i> Export Report
                            </button>
                        </div>
                        <table class="w-full">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Employee</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Status</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Clock In</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Hours</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200" id="attendanceTable">
                                <tr><td colspan="4" class="px-6 py-8 text-center text-gray-500">No employees added yet</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Calendar View -->
                <div id="view-calendar" class="hidden space-y-6">
                    <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6">
                        <div class="flex items-center justify-between mb-6">
                            <h2 class="text-2xl font-bold text-gray-800" id="calendarMonth">February 2026</h2>
                            <div class="flex gap-2">
                                <button onclick="changeMonth(-1)" class="p-2 hover:bg-gray-100 rounded-lg"><i class="fas fa-chevron-left"></i></button>
                                <button onclick="goToToday()" class="px-4 py-2 bg-indigo-50 text-indigo-600 rounded-lg font-medium hover:bg-indigo-100">Today</button>
                                <button onclick="changeMonth(1)" class="p-2 hover:bg-gray-100 rounded-lg"><i class="fas fa-chevron-right"></i></button>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-7 gap-px bg-gray-200 border border-gray-200 rounded-lg overflow-hidden">
                            <div class="bg-gray-50 p-3 text-center text-sm font-semibold text-gray-600">Sun</div>
                            <div class="bg-gray-50 p-3 text-center text-sm font-semibold text-gray-600">Mon</div>
                            <div class="bg-gray-50 p-3 text-center text-sm font-semibold text-gray-600">Tue</div>
                            <div class="bg-gray-50 p-3 text-center text-sm font-semibold text-gray-600">Wed</div>
                            <div class="bg-gray-50 p-3 text-center text-sm font-semibold text-gray-600">Thu</div>
                            <div class="bg-gray-50 p-3 text-center text-sm font-semibold text-gray-600">Fri</div>
                            <div class="bg-gray-50 p-3 text-center text-sm font-semibold text-gray-600">Sat</div>
                        </div>
                        <div class="grid grid-cols-7 gap-px bg-gray-200" id="calendarGrid"></div>
                    </div>

                    <!-- Upcoming Events Section -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="font-semibold text-lg">Upcoming Events</h3>
                                <button onclick="openEventModal()" class="text-indigo-600 hover:text-indigo-800 text-sm font-medium">
                                    <i class="fas fa-plus mr-1"></i> Add Event
                                </button>
                            </div>
                            <div id="upcomingEventsList" class="space-y-3">
                                <p class="text-gray-500 text-center py-4">No upcoming events</p>
                            </div>
                        </div>
                        
                        <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                            <h3 class="font-semibold text-lg mb-4">Event Categories</h3>
                            <div class="space-y-3">
                                <div class="flex items-center gap-3 p-3 bg-blue-50 rounded-lg">
                                    <span class="w-4 h-4 bg-blue-500 rounded-full"></span>
                                    <span class="flex-1">Meetings</span>
                                    <span class="text-sm text-gray-500" id="meetingCount">0</span>
                                </div>
                                <div class="flex items-center gap-3 p-3 bg-green-50 rounded-lg">
                                    <span class="w-4 h-4 bg-green-500 rounded-full"></span>
                                    <span class="flex-1">Leave/Holiday</span>
                                    <span class="text-sm text-gray-500" id="leaveEventCount">0</span>
                                </div>
                                <div class="flex items-center gap-3 p-3 bg-purple-50 rounded-lg">
                                    <span class="w-4 h-4 bg-purple-500 rounded-full"></span>
                                    <span class="flex-1">Deadlines</span>
                                    <span class="text-sm text-gray-500" id="deadlineCount">0</span>
                                </div>
                                <div class="flex items-center gap-3 p-3 bg-orange-50 rounded-lg">
                                    <span class="w-4 h-4 bg-orange-500 rounded-full"></span>
                                    <span class="flex-1">Other</span>
                                    <span class="text-sm text-gray-500" id="otherEventCount">0</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Employees View (ADMIN ONLY) -->
                <div id="view-employees" class="hidden space-y-6">
                    <div class="flex justify-between items-center">
                        <h2 class="text-2xl font-bold text-gray-800">Employee Management</h2>
                        <button onclick="openAddEmployeeModal()" class="px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition flex items-center gap-2">
                            <i class="fas fa-plus"></i> Add Employee
                        </button>
                    </div>

                    <div class="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">
                        <div class="p-4 border-b border-gray-200 flex gap-4">
                            <input type="text" id="searchEmployees" placeholder="Search by name..." class="px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none" onkeyup="searchEmployees()">
                            <select id="filterDept" class="px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none" onchange="filterEmployees()">
                                <option value="">All Departments</option>
                                <option value="Engineering">Engineering</option>
                                <option value="Design">Design</option>
                                <option value="Marketing">Marketing</option>
                                <option value="HR">HR</option>
                                <option value="Sales">Sales</option>
                            </select>
                            <select id="filterStatus" class="px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none" onchange="filterEmployees()">
                                <option value="">All Status</option>
                                <option value="active">Active</option>
                                <option value="offline">Offline</option>
                                <option value="leave">On Leave</option>
                            </select>
                        </div>
                        
                        <div id="employeesGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 p-6">
                            <div class="col-span-full text-center py-12 text-gray-500">
                                <i class="fas fa-users text-4xl mb-4 text-gray-300"></i>
                                <p>No employees added yet. Click "Add Employee" to get started.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Messages View -->
                <div id="view-messages" class="hidden h-[calc(100vh-140px)] flex gap-6">
                    <div class="w-80 bg-white rounded-xl shadow-sm border border-gray-100 flex flex-col">
                        <div class="p-4 border-b border-gray-200">
                            <h3 class="font-semibold">Conversations</h3>
                        </div>
                        <div class="flex-1 overflow-y-auto p-4">
                            <div class="text-center text-gray-400 py-8 text-sm">No messages yet</div>
                        </div>
                    </div>
                    
                    <div class="flex-1 bg-white rounded-xl shadow-sm border border-gray-100 flex flex-col items-center justify-center text-gray-400">
                        <i class="fas fa-comments text-4xl mb-4"></i>
                        <p>Select a conversation to start messaging</p>
                    </div>
                </div>

                <!-- Profile Modal -->
                <div id="profileModal" class="modal">
                    <div class="modal-content p-6 m-4">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-bold">Employee Profile</h2>
                            <button onclick="closeModal('profileModal')" class="text-gray-400 hover:text-gray-600"><i class="fas fa-times text-xl"></i></button>
                        </div>
                        <div id="profileContent" class="space-y-4"></div>
                    </div>
                </div>

                <!-- Add Employee Modal -->
                <div id="addEmployeeModal" class="modal">
                    <div class="modal-content p-6 m-4 max-w-lg">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-bold">Add New Employee</h2>
                            <button onclick="closeModal('addEmployeeModal')" class="text-gray-400 hover:text-gray-600"><i class="fas fa-times text-xl"></i></button>
                        </div>
                        <form onsubmit="saveEmployee(event)" class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Full Name *</label>
                                <input type="text" name="name" required class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none">
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Email *</label>
                                    <input type="email" name="email" required class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Phone</label>
                                    <input type="tel" name="phone" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none">
                                </div>
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Department *</label>
                                    <select name="dept" required class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none">
                                        <option value="Engineering">Engineering</option>
                                        <option value="Design">Design</option>
                                        <option value="Marketing">Marketing</option>
                                        <option value="HR">HR</option>
                                        <option value="Sales">Sales</option>
                                        <option value="Operations">Operations</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Role/Position *</label>
                                    <input type="text" name="role" required class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none">
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Status</label>
                                <select name="status" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none">
                                    <option value="active">Active</option>
                                    <option value="offline">Offline</option>
                                    <option value="leave">On Leave</option>
                                </select>
                            </div>
                            <div class="pt-4 flex gap-3">
                                <button type="button" onclick="closeModal('addEmployeeModal')" class="flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">Cancel</button>
                                <button type="submit" class="flex-1 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700">Add Employee</button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Add Event Modal -->
                <div id="eventModal" class="modal">
                    <div class="modal-content p-6 m-4 max-w-lg">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-bold">Add Event</h2>
                            <button onclick="closeModal('eventModal')" class="text-gray-400 hover:text-gray-600"><i class="fas fa-times text-xl"></i></button>
                        </div>
                        <form onsubmit="saveEvent(event)" class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Event Title *</label>
                                <input type="text" name="title" required class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none" placeholder="Team Meeting">
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Date *</label>
                                    <input type="date" name="date" required class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Time</label>
                                    <input type="time" name="time" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none">
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Event Type</label>
                                <select name="type" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none">
                                    <option value="meeting">Meeting</option>
                                    <option value="leave">Leave/Holiday</option>
                                    <option value="deadline">Deadline</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                                <textarea name="description" rows="3" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none" placeholder="Add details..."></textarea>
                            </div>
                            <div class="pt-4 flex gap-3">
                                <button type="button" onclick="closeModal('eventModal')" class="flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">Cancel</button>
                                <button type="submit" class="flex-1 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700">Add Event</button>
                            </div>
                        </form>
                    </div>
                </div>

            </div>
        </main>
    </div>

    <script>
        // App State
        let currentUser = null;
        let userRole = null;
        let timerInterval = null;
        let timerSeconds = 0;
        let isTimerRunning = false;
        let employees = [];
        let events = [];
        let channels = [
            { id: 'general', name: 'general', icon: 'fa-hashtag', desc: 'Company-wide announcements' },
            { id: 'random', name: 'random', icon: 'fa-hashtag', desc: 'Off-topic conversations' }
        ];
        let attendanceChart = null;
        let currentMonth = new Date();

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            updateDate();
            renderChannels();
            generateCalendar();
            updateStats();
        });

        function updateDate() {
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('currentDate').textContent = new Date().toLocaleDateString('en-US', options);
        }

        // Role Selection
        function selectRole(role) {
            userRole = role;
            document.querySelectorAll('.role-btn').forEach(btn => btn.classList.remove('border-indigo-500', 'bg-indigo-50'));
            document.getElementById(`btn-${role}`).classList.add('border-indigo-500', 'bg-indigo-50');
            document.getElementById('loginFields').classList.remove('hidden');
            document.getElementById('selectedRoleText').textContent = role === 'admin' ? 'Administrator' : 'Employee';
        }

        // Auth
        function handleLogin() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            if (email && password === 'password') {
                currentUser = {
                    email: email,
                    name: email.split('@')[0].replace('.', ' ').replace(/\b\w/g, l => l.toUpperCase()),
                    role: userRole === 'admin' ? 'Administrator' : 'Employee'
                };
                
                document.getElementById('loginScreen').classList.add('hidden');
                document.getElementById('mainApp').classList.remove('hidden');
                
                document.getElementById('currentUserName').textContent = currentUser.name;
                document.getElementById('currentUserRole').textContent = currentUser.role;
                document.getElementById('currentUserAvatar').src = `https://ui-avatars.com/api/?name=${currentUser.name}&background=6366f1&color=fff`;
                document.getElementById('userRoleDisplay').textContent = currentUser.role;
                
                applyRoleAccess();
                
                if (userRole === 'admin') {
                    setTimeout(initChart, 100);
                }
            } else {
                alert('Invalid password. Use "password" for demo.');
            }
        }

        function applyRoleAccess() {
            if (userRole !== 'admin') {
                document.querySelectorAll('.admin-only').forEach(el => el.classList.add('hidden-access'));
                if (window.location.hash === '#employees') {
                    switchTab('dashboard');
                }
            }
        }

        function logout() {
            location.reload();
        }

        // Navigation
        function switchTab(tab) {
            if (userRole !== 'admin' && tab === 'employees') {
                alert('Admin access required');
                return;
            }
            
            document.querySelectorAll('[id^="view-"]').forEach(el => el.classList.add('hidden'));
            document.querySelectorAll('.sidebar-item').forEach(el => el.classList.remove('active'));
            
            document.getElementById(`view-${tab}`).classList.remove('hidden');
            const navEl = document.getElementById(`nav-${tab}`);
            if (navEl) navEl.classList.add('active');
            
            const titles = {
                dashboard: 'Dashboard',
                attendance: 'Time Tracker',
                calendar: 'Calendar',
                employees: 'Employees',
                messages: 'Messages',
                channel: 'Channel'
            };
            document.getElementById('pageTitle').textContent = titles[tab] || tab;
            
            if (tab === 'calendar') {
                generateCalendar();
                renderUpcomingEvents();
            }
            if (tab === 'employees') renderEmployees();
        }

        // Timer
        function toggleTimer() {
            const btn = document.getElementById('timerBtn');
            const btnText = document.getElementById('timerBtnText');
            const btnIcon = document.getElementById('timerBtnIcon');
            const status = document.getElementById('timerStatus');
            const circle = document.getElementById('timerCircle');
            const breakBtn = document.getElementById('breakBtn');
            
            if (!isTimerRunning) {
                isTimerRunning = true;
                btnText.textContent = 'Clock Out';
                btnIcon.className = 'fas fa-stop';
                btn.classList.remove('bg-indigo-600', 'hover:bg-indigo-700');
                btn.classList.add('bg-red-600', 'hover:bg-red-700');
                status.textContent = 'Working...';
                circle.classList.add('pulse-ring');
                breakBtn.classList.remove('hidden');
                
                timerInterval = setInterval(() => {
                    timerSeconds++;
                    updateTimerDisplay();
                }, 1000);
            } else {
                clearInterval(timerInterval);
                isTimerRunning = false;
                btnText.textContent = 'Clock In';
                btnIcon.className = 'fas fa-play';
                btn.classList.add('bg-indigo-600', 'hover:bg-indigo-700');
                btn.classList.remove('bg-red-600', 'hover:bg-red-700');
                status.textContent = 'Shift ended';
                circle.classList.remove('pulse-ring');
                breakBtn.classList.add('hidden');
            }
        }

        function updateTimerDisplay() {
            const hours = Math.floor(timerSeconds / 3600);
            const minutes = Math.floor((timerSeconds % 3600) / 60);
            const seconds = timerSeconds % 60;
            document.getElementById('timerDisplay').textContent = 
                `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }

        function takeBreak() {
            alert('Break timer started! (15 minutes)');
        }

        // Calendar with Events
        function generateCalendar() {
            const year = currentMonth.getFullYear();
            const month = currentMonth.getMonth();
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            
            document.getElementById('calendarMonth').textContent = currentMonth.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
            
            const grid = document.getElementById('calendarGrid');
            grid.innerHTML = '';
            
            for (let i = 0; i < firstDay; i++) {
                grid.innerHTML += '<div class="bg-white p-2 min-h-[100px]"></div>';
            }
            
            const today = new Date().getDate();
            const currentMonthIndex = new Date().getMonth();
            const currentYear = new Date().getFullYear();
            const isCurrentMonth = (currentMonthIndex === month && currentYear === year);
            
            for (let day = 1; day <= daysInMonth; day++) {
                const isToday = isCurrentMonth && day === today;
                const dayEvents = getEventsForDay(year, month, day);
                
                let eventHtml = '';
                dayEvents.slice(0, 3).forEach(event => {
                    const colorClass = getEventColor(event.type);
                    eventHtml += `<div class="event-item ${colorClass}" onclick="viewEvent(${event.id})">${event.title}</div>`;
                });
                if (dayEvents.length > 3) {
                    eventHtml += `<div class="text-xs text-gray-500 mt-1">+${dayEvents.length - 3} more</div>`;
                }
                
                grid.innerHTML += `
                    <div class="calendar-day bg-white p-2 relative ${isToday ? 'bg-indigo-50 border-2 border-indigo-200' : ''}" onclick="openEventModal(${year}, ${month}, ${day})">
                        <span class="text-sm font-medium ${isToday ? 'text-indigo-600' : 'text-gray-700'}">${day}</span>
                        ${eventHtml}
                    </div>
                `;
            }
        }

        function getEventsForDay(year, month, day) {
            return events.filter(e => {
                const eventDate = new Date(e.date);
                return eventDate.getFullYear() === year && 
                       eventDate.getMonth() === month && 
                       eventDate.getDate() === day;
            });
        }

        function getEventColor(type) {
            const colors = {
                meeting: 'bg-blue-100 text-blue-800 border-l-2 border-blue-500',
                leave: 'bg-green-100 text-green-800 border-l-2 border-green-500',
                deadline: 'bg-purple-100 text-purple-800 border-l-2 border-purple-500',
                other: 'bg-orange-100 text-orange-800 border-l-2 border-orange-500'
            };
            return colors[type] || colors.other;
        }

        function changeMonth(delta) {
            currentMonth.setMonth(currentMonth.getMonth() + delta);
            generateCalendar();
        }

        function goToToday() {
            currentMonth = new Date();
            generateCalendar();
        }

        // Event Management
        function openEventModal(year, month, day) {
            const dateInput = document.querySelector('#eventModal input[name="date"]');
            if (year !== undefined) {
                const date = new Date(year, month, day);
                dateInput.value = date.toISOString().split('T')[0];
            } else {
                dateInput.value = new Date().toISOString().split('T')[0];
            }
            document.getElementById('eventModal').classList.add('active');
        }

        function saveEvent(e) {
            e.preventDefault();
            const formData = new FormData(e.target);
            
            const newEvent = {
                id: Date.now(),
                title: formData.get('title'),
                date: formData.get('date'),
                time: formData.get('time'),
                type: formData.get('type'),
                description: formData.get('description')
            };
            
            events.push(newEvent);
            closeModal('eventModal');
            e.target.reset();
            generateCalendar();
            renderUpcomingEvents();
            updateEventCounts();
            showNotification('Event added successfully!');
        }

        function viewEvent(id) {
            const event = events.find(e => e.id === id);
            if (!event) return;
            
            const typeColors = {
                meeting: 'blue',
                leave: 'green',
                deadline: 'purple',
                other: 'orange'
            };
            
            alert(`Event: ${event.title}\nDate: ${event.date}\nTime: ${event.time || 'All day'}\nType: ${event.type}\n\n${event.description || 'No description'}`);
        }

        function renderUpcomingEvents() {
            const container = document.getElementById('upcomingEventsList');
            const upcoming = events
                .filter(e => new Date(e.date) >= new Date())
                .sort((a, b) => new Date(a.date) - new Date(b.date))
                .slice(0, 5);
            
            if (upcoming.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center py-4">No upcoming events</p>';
                return;
            }
            
            container.innerHTML = upcoming.map(event => {
                const date = new Date(event.date);
                const day = date.getDate();
                const month = date.toLocaleDateString('en-US', { month: 'short' });
                const colorClass = getEventColor(event.type);
                
                return `
                    <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer" onclick="viewEvent(${event.id})">
                        <div class="w-12 h-12 bg-white rounded-lg flex flex-col items-center justify-center border border-gray-200">
                            <span class="text-xs text-gray-500 uppercase">${month}</span>
                            <span class="text-lg font-bold text-gray-800">${day}</span>
                        </div>
                        <div class="flex-1 min-w-0">
                            <p class="font-medium text-gray-900 truncate">${event.title}</p>
                            <p class="text-sm text-gray-500">${event.time || 'All day'} • ${event.type}</p>
                        </div>
                        <span class="w-3 h-3 rounded-full ${event.type === 'meeting' ? 'bg-blue-500' : event.type === 'leave' ? 'bg-green-500' : event.type === 'deadline' ? 'bg-purple-500' : 'bg-orange-500'}"></span>
                    </div>
                `;
            }).join('');
        }

        function updateEventCounts() {
            document.getElementById('meetingCount').textContent = events.filter(e => e.type === 'meeting').length;
            document.getElementById('leaveEventCount').textContent = events.filter(e => e.type === 'leave').length;
            document.getElementById('deadlineCount').textContent = events.filter(e => e.type === 'deadline').length;
            document.getElementById('otherEventCount').textContent = events.filter(e => e.type === 'other').length;
        }

        // Employee Management
        function openAddEmployeeModal() {
            document.getElementById('addEmployeeModal').classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        function saveEmployee(e) {
            e.preventDefault();
            const formData = new FormData(e.target);
            
            const newEmployee = {
                id: employees.length + 1,
                name: formData.get('name'),
                email: formData.get('email'),
                phone: formData.get('phone'),
                dept: formData.get('dept'),
                role: formData.get('role'),
                status: formData.get('status'),
                avatar: formData.get('name').replace(' ', '+'),
                hours: '0h',
                joinDate: new Date().toLocaleDateString()
            };
            
            employees.push(newEmployee);
            closeModal('addEmployeeModal');
            e.target.reset();
            renderEmployees();
            updateStats();
            showNotification('Employee added successfully!');
        }

        function renderEmployees() {
            const grid = document.getElementById('employeesGrid');
            
            if (employees.length === 0) {
                grid.innerHTML = `
                    <div class="col-span-full text-center py-12 text-gray-500">
                        <i class="fas fa-users text-4xl mb-4 text-gray-300"></i>
                        <p>No employees added yet. Click "Add Employee" to get started.</p>
                    </div>
                `;
                return;
            }
            
            grid.innerHTML = employees.map(emp => `
                <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6 hover:shadow-md transition">
                    <div class="flex items-start justify-between mb-4">
                        <div class="flex items-center gap-4">
                            <img src="https://ui-avatars.com/api/?name=${emp.avatar}&background=random" class="w-12 h-12 rounded-full">
                            <div>
                                <h3 class="font-semibold text-gray-800">${emp.name}</h3>
                                <p class="text-sm text-gray-500">${emp.role}</p>
                                <span class="inline-block mt-1 text-xs px-2 py-1 rounded-full ${getStatusColor(emp.status)}">${emp.status}</span>
                            </div>
                        </div>
                        <div class="relative group">
                            <button class="text-gray-400 hover:text-gray-600"><i class="fas fa-ellipsis-v"></i></button>
                            <div class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 hidden group-hover:block z-10">
                                <button onclick="viewProfile(${emp.id})" class="w-full text-left px-4 py-2 hover:bg-gray-50 text-sm"><i class="fas fa-user mr-2"></i>View Profile</button>
                                <button onclick="messageEmployee(${emp.id})" class="w-full text-left px-4 py-2 hover:bg-gray-50 text-sm"><i class="fas fa-envelope mr-2"></i>Send Message</button>
                                <button onclick="editEmployee(${emp.id})" class="w-full text-left px-4 py-2 hover:bg-gray-50 text-sm"><i class="fas fa-edit mr-2"></i>Edit</button>
                                <button onclick="deleteEmployee(${emp.id})" class="w-full text-left px-4 py-2 hover:bg-gray-50 text-sm text-red-600"><i class="fas fa-trash mr-2"></i>Delete</button>
                            </div>
                        </div>
                    </div>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between"><span class="text-gray-500">Department:</span> <span class="font-medium">${emp.dept}</span></div>
                        <div class="flex justify-between"><span class="text-gray-500">Email:</span> <span class="font-medium truncate max-w-[150px]">${emp.email}</span></div>
                        <div class="flex justify-between"><span class="text-gray-500">Hours:</span> <span class="font-medium">${emp.hours}</span></div>
                    </div>
                    <div class="mt-4 pt-4 border-t border-gray-100 flex gap-2">
                        <button onclick="viewProfile(${emp.id})" class="flex-1 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50">View Profile</button>
                        <button onclick="messageEmployee(${emp.id})" class="flex-1 py-2 text-sm bg-indigo-50 text-indigo-600 rounded-lg hover:bg-indigo-100">Message</button>
                    </div>
                </div>
            `).join('');
            
            renderAttendanceTable();
        }

        function getStatusColor(status) {
            const colors = { active: 'bg-green-100 text-green-800', offline: 'bg-gray-100 text-gray-800', leave: 'bg-orange-100 text-orange-800' };
            return colors[status] || 'bg-gray-100 text-gray-800';
        }

        function viewProfile(id) {
            const emp = employees.find(e => e.id === id);
            if (!emp) return;
            
            document.getElementById('profileContent').innerHTML = `
                <div class="text-center mb-6">
                    <img src="https://ui-avatars.com/api/?name=${emp.avatar}&background=random&size=128" class="w-24 h-24 rounded-full mx-auto mb-4">
                    <h3 class="text-xl font-bold">${emp.name}</h3>
                    <p class="text-gray-500">${emp.role}</p>
                    <span class="inline-block mt-2 px-3 py-1 rounded-full text-sm ${getStatusColor(emp.status)}">${emp.status}</span>
                </div>
                <div class="space-y-3">
                    <div class="flex justify-between py-2 border-b"><span class="text-gray-500">Department</span> <span class="font-medium">${emp.dept}</span></div>
                    <div class="flex justify-between py-2 border-b"><span class="text-gray-500">Email</span> <span class="font-medium">${emp.email}</span></div>
                    <div class="flex justify-between py-2 border-b"><span class="text-gray-500">Phone</span> <span class="font-medium">${emp.phone || 'N/A'}</span></div>
                    <div class="flex justify-between py-2 border-b"><span class="text-gray-500">Join Date</span> <span class="font-medium">${emp.joinDate}</span></div>
                    <div class="flex justify-between py-2 border-b"><span class="text-gray-500">Total Hours</span> <span class="font-medium">${emp.hours}</span></div>
                </div>
                <div class="mt-6 flex gap-3">
                    <button onclick="messageEmployee(${emp.id}); closeModal('profileModal');" class="flex-1 bg-indigo-600 text-white py-2 rounded-lg hover:bg-indigo-700">Send Message</button>
                    <button onclick="closeModal('profileModal')" class="flex-1 border border-gray-300 py-2 rounded-lg hover:bg-gray-50">Close</button>
                </div>
            `;
            document.getElementById('profileModal').classList.add('active');
        }

        function messageEmployee(id) {
            const emp = employees.find(e => e.id === id);
            switchTab('messages');
            showNotification(`Starting conversation with ${emp.name}...`);
        }

        function editEmployee(id) {
            showNotification('Edit functionality - Add your edit logic here');
        }

        function deleteEmployee(id) {
            if (confirm('Are you sure you want to remove this employee?')) {
                employees = employees.filter(e => e.id !== id);
                renderEmployees();
                updateStats();
                showNotification('Employee removed');
            }
        }

        function searchEmployees() {
            const term = document.getElementById('searchEmployees').value.toLowerCase();
            filterAndRender(term);
        }

        function filterEmployees() {
            const term = document.getElementById('searchEmployees').value.toLowerCase();
            filterAndRender(term);
        }

        function filterAndRender(searchTerm) {
            const dept = document.getElementById('filterDept').value;
            const status = document.getElementById('filterStatus').value;
            
            let filtered = employees.filter(emp => {
                const matchesSearch = emp.name.toLowerCase().includes(searchTerm) || emp.email.toLowerCase().includes(searchTerm);
                const matchesDept = !dept || emp.dept === dept;
                const matchesStatus = !status || emp.status === status;
                return matchesSearch && matchesDept && matchesStatus;
            });
            
            const grid = document.getElementById('employeesGrid');
            if (filtered.length === 0) {
                grid.innerHTML = '<div class="col-span-full text-center py-8 text-gray-500">No employees match your criteria</div>';
                return;
            }
            
            grid.innerHTML = filtered.map(emp => `
                <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6 hover:shadow-md transition">
                    <div class="flex items-start justify-between mb-4">
                        <div class="flex items-center gap-4">
                            <img src="https://ui-avatars.com/api/?name=${emp.avatar}&background=random" class="w-12 h-12 rounded-full">
                            <div>
                                <h3 class="font-semibold text-gray-800">${emp.name}</h3>
                                <p class="text-sm text-gray-500">${emp.role}</p>
                                <span class="inline-block mt-1 text-xs px-2 py-1 rounded-full ${getStatusColor(emp.status)}">${emp.status}</span>
                            </div>
                        </div>
                    </div>
                    <div class="mt-4 flex gap-2">
                        <button onclick="viewProfile(${emp.id})" class="flex-1 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50">View Profile</button>
                        <button onclick="messageEmployee(${emp.id})" class="flex-1 py-2 text-sm bg-indigo-50 text-indigo-600 rounded-lg hover:bg-indigo-100">Message</button>
                    </div>
                </div>
            `).join('');
        }

        function renderAttendanceTable() {
            const tbody = document.getElementById('attendanceTable');
            if (employees.length === 0) {
                tbody.innerHTML = '<tr><td colspan="4" class="px-6 py-8 text-center text-gray-500">No employees added yet</td></tr>';
                return;
            }
            
            tbody.innerHTML = employees.map(emp => `
                <tr class="hover:bg-gray-50">
                    <td class="px-6 py-4 flex items-center gap-3">
                        <img src="https://ui-avatars.com/api/?name=${emp.avatar}&background=random" class="w-8 h-8 rounded-full">
                        <span class="font-medium text-gray-900">${emp.name}</span>
                    </td>
                    <td class="px-6 py-4"><span class="px-2 py-1 text-xs rounded-full ${getStatusColor(emp.status)}">${emp.status}</span></td>
                    <td class="px-6 py-4 text-gray-600">${emp.status === 'active' ? '09:00 AM' : '-'}</td>
                    <td class="px-6 py-4 font-mono text-gray-600">${emp.hours}</td>
                </tr>
            `).join('');
        }

        function updateStats() {
            document.getElementById('totalEmployees').textContent = employees.length;
            document.getElementById('workingCount').textContent = employees.filter(e => e.status === 'active').length;
            document.getElementById('leaveCount').textContent = employees.filter(e => e.status === 'leave').length;
        }

        // Channels
        function renderChannels() {
            const container = document.getElementById('channelsList');
            container.innerHTML = channels.map(ch => `
                <a href="#" onclick="openChannel('${ch.id}')" class="sidebar-item flex items-center gap-3 px-6 py-2 text-gray-600 hover:text-indigo-600">
                    <i class="fas ${ch.icon} w-5 text-gray-400"></i>
                    <span class="truncate">${ch.name}</span>
                </a>
            `).join('');
        }

        function openChannel(channelId) {
            const channel = channels.find(c => c.id === channelId);
            alert(`Channel: #${channel.name}\n\n${channel.desc}\n\n(Channel chat would open here)`);
        }

        function createNewChannel() {
            if (userRole !== 'admin') {
                alert('Only admins can create channels');
                return;
            }
            const name = prompt('Enter channel name:');
            if (name) {
                channels.push({
                    id: name.toLowerCase().replace(/\s+/g, '-'),
                    name: name,
                    icon: 'fa-hashtag',
                    desc: `Channel for ${name}`
                });
                renderChannels();
            }
        }

        // Reports
        function generateReport() {
            if (employees.length === 0) {
                alert('No employee data to report');
                return;
            }
            const csvContent = "data:text/csv;charset=utf-8," 
                + "Name,Department,Role,Status,Hours,Email\n"
                + employees.map(e => `${e.name},${e.dept},${e.role},${e.status},${e.hours},${e.email}`).join("\n");
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "employee_report.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function showNotification(message) {
            const notif = document.createElement('div');
            notif.className = 'fixed bottom-4 right-4 bg-gray-800 text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-bounce';
            notif.textContent = message;
            document.body.appendChild(notif);
            setTimeout(() => notif.remove(), 3000);
        }

        // Fixed Chart Initialization
        function initChart() {
            const ctx = document.getElementById('attendanceChart');
            if (!ctx) return;
            
            // Destroy existing chart if it exists
            if (attendanceChart) {
                attendanceChart.destroy();
            }
            
            attendanceChart = new Chart(ctx.getContext('2d'), {
                type: 'bar',
                data: {
                    labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri'],
                    datasets: [{
                        label: 'Hours Worked',
                        data: employees.length > 0 ? [8, 7.5, 8, 8.5, 7] : [0, 0, 0, 0, 0],
                        backgroundColor: '#6366f1',
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { 
                        legend: { display: false }
                    },
                    scales: {
                        y: { 
                            beginAtZero: true, 
                            max: 10,
                            ticks: { stepSize: 2 }
                        },
                        x: {
                            grid: { display: false }
                        }
                    }
                }
            });
        }

        // Close modals on outside click
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.classList.remove('active');
            }
        }
    </script>
</body>
</html>
